services:
  server:
    image: ghcr.io/martinbjeldbak/acestream-http-proxy
    container_name: acestream-http-proxy
    ports:
      - '6878:80'
    env_file:
      - .env
    networks:
      - acestream-network

  app:
    build: .
    container_name: link-scraper
    env_file:
      - .env
    volumes:
      - ./playlist:/usr/src/app/playlist
    depends_on:
      - server
    entrypoint:
      [
        "/usr/src/app/wait-for-acestream.sh",
        "server:80",
        "python",
        "main.py"
      ]
    networks:
      - acestream-network

networks:
  acestream-network:
    driver: bridge
